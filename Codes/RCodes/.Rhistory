knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(tidyr)
library(cluster)
library(factoextra)
library(NbClust)
df=read_csv('../../FinalData/finaldata.rds')
non_na=df %>% filter(Urban_Rural_New==1) %>%  drop_na()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(tidyr)
library(cluster)
library(factoextra)
library(NbClust)
df=readRds('../../FinalData/finaldata.rds')
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(tidyr)
library(cluster)
library(factoextra)
library(NbClust)
df=readRDS('../../FinalData/finaldata.rds')
non_na=df %>% filter(Urban_Rural_New==1) %>%  drop_na()
non_na=df %>% dplyr::filter(Urban_Rural_New==1) %>%  drop_na()
non_na=df %>% dplyr::filter(Urban_Rural_New==1) %>%  drop_na()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(tidyr)
library(cluster)
library(factoextra)
library(NbClust)
df=readRDS('../../FinalData/finaldata.rds')
non_na=df %>% dplyr::filter(Urban_Rural_New==1) %>%  drop_na()
non_na=df %>% select(-geometry) %>% dplyr::filter(Urban_Rural_New==1) %>%  drop_na()
five_be_df = non_na %>% select(prop_dilapbldg, prop_green, prop_crosswalk, prop_not_single_family_home, prop_single_lane)
set.seed(123)
fviz_nbclust(five_be_df, clara, method = "gap_stat", nboot = 50)+
labs(subtitle = "Gap statistic method")
clara.res <- clara(five_be_df, 4, samples = 50, pamLike = TRUE)
print(clara.res)
non_na_with_cluster=cbind(non_na, cluster = clara.res$cluster)
write_csv(non_na_with_cluster,'../../FinalData/four_cluster_urban.csv')
fviz_cluster(clara.res, geom="point",
alpha=0.1,shape=19,
show.clust.cent=TRUE, ellipse.alpha=0.3)
clara.res <- clara(five_be_df, 5, samples = 50, pamLike = TRUE)
fviz_cluster(clara.res, geom="point",
alpha=0.1,shape=19,
show.clust.cent=TRUE, ellipse.alpha=0.3)
library(sf)
library(tidyr)
library(tidyverse)
library(dplyr)
library(corrplot)
library(ggcorrplot)
library(reshape2)
library(car)
library(reshape)
library(knitr)
library(stringr)
library(effects)
library(corrplot)
library(vtable)
library(metan)
library(ggplot2)
library(ggridges)
library(gtsummary)
knitr::opts_chunk$set(echo = TRUE)
# Load data
df <- readRDS(file = "../../FinalData/finaldata.rds")
df_holc <- readRDS("../../FinalData/finaldata_holc.rds")
df$log.median.house.income  <- log(df$Median.household.income)
# Tract Level
df_holc  %>%
filter(Urban_Rural_New == 1) %>%
dplyr::select(sleep_crud, diabetes_c, casthma_cr, prop_dilapbldg,  prop_green, prop_crosswalk, prop_not_single_family_home, prop_single_lane, Median.household.income, Pct_college, Age, Pct_Female, Pct_insurance, Pct_Owner, Pct_Vacant, Pct_SingleFam, majority_grade) %>%
tbl_summary(
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"),
missing = "no",
missing_text = 'Missing',
digits = all_continuous() ~ 2,
label = list(sleep_crud ~"Sleeping Problems", diabetes_c ~ "Diabetes",
casthma_cr~"Asthma", prop_dilapbldg~"% Dilapidated", prop_green~"% Green space", prop_crosswalk~"% Crosswalk", prop_not_single_family_home~"% Non-single Family Home", prop_single_lane~"% Single Lane", Median.household.income~"Median Household Income", Pct_college~"% College", Age~"Age", Pct_Female~"% Female", Pct_insurance~"% Insured", Pct_Owner~ "% Owner Occupied Housing", Pct_Vacant~"% Vacant Housing", Pct_SingleFam~"% Single Female Head of Household with Children", majority_grade~"HOLC Grade"
)
) %>% add_n()
# Population Level
df_holc %>% summarise(White = sum(Pop_White),
Black = sum(Pop_Black),
Native = sum(Pop_Native),
Asian = sum(Pop_Asian),
HIPI= sum(Pop_HIPI),
Hispanic= sum(Pop_Hispanic),
TotalPop=sum(TotalPop),
"% Non-Hispanic White" = sum(Pop_White)/sum(TotalPop),
"% Non-Hispanic Black" = sum(Pop_Black)/sum(TotalPop),
"% American Indian/Alaska Native" = sum(Pop_Native)/sum(TotalPop),
"% Asian" = sum(Pop_Asian)/sum(TotalPop),
"% Native Hawaiian and Other Pacific Islander"= sum(Pop_HIPI)/sum(TotalPop),
"% Hispanic"= sum(Pop_Hispanic)/sum(TotalPop),
) %>% t()
library(sf)
library(tidyr)
library(tidyverse)
library(dplyr)
library(corrplot)
library(ggcorrplot)
library(reshape2)
library(car)
library(reshape)
library(knitr)
library(stringr)
library(effects)
library(corrplot)
library(vtable)
library(metan)
library(ggplot2)
library(ggridges)
library(gtsummary)
knitr::opts_chunk$set(echo = TRUE)
# Load data
df <- readRDS(file = "../../FinalData/finaldata.rds")
df_holc <- readRDS("../../FinalData/finaldata_holc.rds")
df$log.median.house.income  <- log(df$Median.household.income)
# Tract Level
df_holc  %>%
filter(Urban_Rural_New == 1) %>%
dplyr::select(sleep_crud, diabetes_c, casthma_cr, prop_dilapbldg,  prop_green, prop_crosswalk, prop_not_single_family_home, prop_single_lane, Median.household.income, Pct_college, Age, Pct_Female, Pct_insurance, Pct_Owner, Pct_Vacant, Pct_SingleFam, majority_grade) %>%
tbl_summary(
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"),
missing = "no",
missing_text = 'Missing',
digits = all_continuous() ~ 2,
label = list(sleep_crud ~"Sleeping Problems", diabetes_c ~ "Diabetes",
casthma_cr~"Asthma", prop_dilapbldg~"% Dilapidated", prop_green~"% Green space", prop_crosswalk~"% Crosswalk", prop_not_single_family_home~"% Non-single Family Home", prop_single_lane~"% Single Lane", Median.household.income~"Median Household Income", Pct_college~"% College", Age~"Age", Pct_Female~"% Female", Pct_insurance~"% Insured", Pct_Owner~ "% Owner Occupied Housing", Pct_Vacant~"% Vacant Housing", Pct_SingleFam~"% Single Female Head of Household with Children", majority_grade~"HOLC Grade"
)
) %>% add_n()
# Population Level
df_holc %>% summarise(White = sum(Pop_White),
Black = sum(Pop_Black),
Native = sum(Pop_Native),
Asian = sum(Pop_Asian),
HIPI= sum(Pop_HIPI),
Hispanic= sum(Pop_Hispanic),
TotalPop=sum(TotalPop),
"% Non-Hispanic White" = sum(Pop_White)/sum(TotalPop),
"% Non-Hispanic Black" = sum(Pop_Black)/sum(TotalPop),
"% American Indian/Alaska Native" = sum(Pop_Native)/sum(TotalPop),
"% Asian" = sum(Pop_Asian)/sum(TotalPop),
"% Native Hawaiian and Other Pacific Islander"= sum(Pop_HIPI)/sum(TotalPop),
"% Hispanic"= sum(Pop_Hispanic)/sum(TotalPop),
) %>% t()
library(sf)
library(tidyr)
library(tidyverse)
library(dplyr)
library(corrplot)
library(ggcorrplot)
library(reshape2)
library(car)
library(reshape)
library(knitr)
library(stringr)
library(effects)
library(corrplot)
library(vtable)
library(metan)
library(ggplot2)
library(ggridges)
library(gtsummary)
knitr::opts_chunk$set(echo = TRUE)
# Load data
df <- readRDS(file = "../../FinalData/finaldata.rds")
df_holc <- readRDS("../../FinalData/finaldata_holc.rds")
# Tract Level
df_holc  %>%
filter(Urban_Rural_New == 1) %>%
dplyr::select(sleep_crud, diabetes_c, casthma_cr, prop_dilapbldg,  prop_green, prop_crosswalk, prop_not_single_family_home, prop_single_lane, Median.household.income, Pct_college, Age, Pct_Female, Pct_insurance, Pct_Owner, Pct_Vacant, Pct_SingleFam, majority_grade) %>%
tbl_summary(
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"),
missing = "no",
missing_text = 'Missing',
digits = all_continuous() ~ 2,
label = list(sleep_crud ~"Sleeping Problems", diabetes_c ~ "Diabetes",
casthma_cr~"Asthma", prop_dilapbldg~"% Dilapidated", prop_green~"% Green space", prop_crosswalk~"% Crosswalk", prop_not_single_family_home~"% Non-single Family Home", prop_single_lane~"% Single Lane", Median.household.income~"Median Household Income", Pct_college~"% College", Age~"Age", Pct_Female~"% Female", Pct_insurance~"% Insured", Pct_Owner~ "% Owner Occupied Housing", Pct_Vacant~"% Vacant Housing", Pct_SingleFam~"% Single Female Head of Household with Children", majority_grade~"HOLC Grade"
)
) %>% add_n()
# Population Level
df_holc %>% summarise(White = sum(Pop_White),
Black = sum(Pop_Black),
Native = sum(Pop_Native),
Asian = sum(Pop_Asian),
HIPI= sum(Pop_HIPI),
Hispanic= sum(Pop_Hispanic),
TotalPop=sum(TotalPop),
"% Non-Hispanic White" = sum(Pop_White)/sum(TotalPop),
"% Non-Hispanic Black" = sum(Pop_Black)/sum(TotalPop),
"% American Indian/Alaska Native" = sum(Pop_Native)/sum(TotalPop),
"% Asian" = sum(Pop_Asian)/sum(TotalPop),
"% Native Hawaiian and Other Pacific Islander"= sum(Pop_HIPI)/sum(TotalPop),
"% Hispanic"= sum(Pop_Hispanic)/sum(TotalPop),
) %>% t()
library(sf)
library(tidyr)
library(tidyverse)
library(dplyr)
library(corrplot)
library(ggcorrplot)
library(reshape2)
library(car)
library(reshape)
library(knitr)
library(stringr)
library(effects)
library(corrplot)
library(vtable)
library(metan)
library(ggplot2)
library(ggridges)
library(gtsummary)
knitr::opts_chunk$set(echo = TRUE)
# Load data
df <- readRDS(file = "../../FinalData/finaldata.rds")
df_holc <- readRDS("../../FinalData/finaldata_holc.rds")
df$log.median.house.income  <- log(df$Median.household.income)
